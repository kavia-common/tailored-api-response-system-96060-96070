{"is_source_file": true, "format": "Python", "description": "This file contains security utilities for JWT handling, including creating, decoding tokens, and retrieving the current user in a FastAPI application. It interacts with user storage to verify and load current user data based on tokens.", "external_files": ["fastapi", "fastapi.security", "jose"], "external_methods": ["Depends", "HTTPException", "status.HTTP_401_UNAUTHORIZED", "OAuth2PasswordBearer", "jwt.encode", "jwt.decode", "jwt.JWTError"], "published": ["create_access_token", "decode_token", "get_current_user"], "classes": [], "methods": [{"name": "Dict[str,Any] get_jwt_config()", "description": "Reads JWT configuration parameters from environment variables, including secret key, algorithm, and token expiration time.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(*, user: UserRecord)", "description": "Creates a JWT token for a given user with their ID, email, and package tier info embedded.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] decode_token(token: str)", "description": "Decodes a given JWT token and returns its payload as a dictionary.", "scope": "", "scopeKind": ""}, {"name": "UserRecord get_current_user(token: str = Depends(oauth2_scheme), store: MemoryUserStore = Depends(lambda: store_singleton))", "description": "FastAPI dependency that extracts and validates the current user from the JWT token in the request.", "scope": "", "scopeKind": ""}, {"name": "None __init__(self)", "scope": "MemoryUserStore", "scopeKind": "class", "description": "unavailable"}, {"name": "None __init__(self, email: str, password_plain: str, package_tier: str = \"free\")", "scope": "UserRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] _get_env(key: str, default: Optional[str] = None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str _hash_password(password_plain: str)", "scope": "UserRecord", "scopeKind": "class", "description": "unavailable"}, {"name": "int _int_env(key: str, default: int)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[UserRecord] authenticate(self, email: str, password_plain: str)", "scope": "MemoryUserStore", "scopeKind": "class", "description": "unavailable"}, {"name": "UserRecord create_user(self, email: str, password_plain: str, package_tier: str = \"free\")", "scope": "MemoryUserStore", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[UserRecord] get_by_email(self, email: str)", "scope": "MemoryUserStore", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[UserRecord] get_by_id(self, user_id: str)", "scope": "MemoryUserStore", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[UserRecord] update_plan(self, user_id: str, package_tier: str)", "scope": "MemoryUserStore", "scopeKind": "class", "description": "unavailable"}, {"name": "bool verify_password(self, password_plain: str)", "scope": "UserRecord", "scopeKind": "class", "description": "unavailable"}], "calls": ["jwt.encode", "jwt.decode", "jwt.JWTError", "load_singleton"], "search-terms": ["JWT", "token creation", "token decoding", "FastAPI security dependencies", "get_current_user", "JWT_SECRET_KEY"], "state": 2, "file_id": 17, "knowledge_revision": 49, "git_revision": "", "ctags": [{"_type": "tag", "name": "MemoryUserStore", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^class MemoryUserStore:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserRecord", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^class UserRecord:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def __init__(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "MemoryUserStore", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def __init__(self, email: str, password_plain: str, package_tier: str = \"free\") -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, email: str, password_plain: str, package_tier: str = \"free\")", "scope": "UserRecord", "scopeKind": "class"}, {"_type": "tag", "name": "_get_env", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^def _get_env(key: str, default: Optional[str] = None) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(key: str, default: Optional[str] = None)"}, {"_type": "tag", "name": "_hash_password", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def _hash_password(password_plain: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(password_plain: str)", "scope": "UserRecord", "scopeKind": "class"}, {"_type": "tag", "name": "_int_env", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^def _int_env(key: str, default: int) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(key: str, default: int)"}, {"_type": "tag", "name": "authenticate", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def authenticate(self, email: str, password_plain: str) -> Optional[UserRecord]:$/", "language": "Python", "typeref": "typename:Optional[UserRecord]", "kind": "member", "signature": "(self, email: str, password_plain: str)", "scope": "MemoryUserStore", "scopeKind": "class"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^def create_access_token(*, user: UserRecord) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*, user: UserRecord)"}, {"_type": "tag", "name": "create_user", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def create_user(self, email: str, password_plain: str, package_tier: str = \"free\") -> UserRe/", "language": "Python", "typeref": "typename:UserRecord", "kind": "member", "signature": "(self, email: str, password_plain: str, package_tier: str = \"free\")", "scope": "MemoryUserStore", "scopeKind": "class"}, {"_type": "tag", "name": "decode_token", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^def decode_token(token: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "get_by_email", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def get_by_email(self, email: str) -> Optional[UserRecord]:$/", "language": "Python", "typeref": "typename:Optional[UserRecord]", "kind": "member", "signature": "(self, email: str)", "scope": "MemoryUserStore", "scopeKind": "class"}, {"_type": "tag", "name": "get_by_id", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def get_by_id(self, user_id: str) -> Optional[UserRecord]:$/", "language": "Python", "typeref": "typename:Optional[UserRecord]", "kind": "member", "signature": "(self, user_id: str)", "scope": "MemoryUserStore", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^def get_current_user(token: str = Depends(oauth2_scheme), store: MemoryUserStore = Depends(lambd/", "language": "Python", "typeref": "typename:UserRecord", "kind": "function", "signature": "(token: str = Depends(oauth2_scheme), store: MemoryUserStore = Depends(lambda: store_singleton))"}, {"_type": "tag", "name": "get_jwt_config", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^def get_jwt_config() -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "store_singleton", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^store_singleton = MemoryUserStore()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_plan", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def update_plan(self, user_id: str, package_tier: str) -> Optional[UserRecord]:$/", "language": "Python", "typeref": "typename:Optional[UserRecord]", "kind": "member", "signature": "(self, user_id: str, package_tier: str)", "scope": "MemoryUserStore", "scopeKind": "class"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/storage.py", "pattern": "/^    def verify_password(self, password_plain: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self, password_plain: str)", "scope": "UserRecord", "scopeKind": "class"}], "hash": "238b463692dbf9c9c8eee1a4fadf0236", "format-version": 4, "code-base-name": "backend", "filename": "backend/app/storage.py", "fields": [{"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "store_singleton = MemoryUserStore()", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"49": ""}]}