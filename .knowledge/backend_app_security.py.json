{"is_source_file": true, "format": "Python", "description": "This file contains security-related logic for a FastAPI application, including JWT token creation, decoding, and user retrieval based on tokens. It manages environment configuration for JWT settings and provides dependencies for endpoint security.", "external_files": ["./storage.py"], "external_methods": ["MemoryUserStore.get_by_id", "jwt.encode", "jwt.decode"], "published": ["create_access_token", "decode_token", "get_current_user"], "classes": [{"name": "UserRecord", "description": "Data class representing a user, including id, email, and package_tier."}], "methods": [{"name": "Optional[str] _get_env(key: str, default: Optional[str] = None)", "description": "Helper function to retrieve environment variables with optional default.", "scope": "", "scopeKind": ""}, {"name": "int _int_env(key: str, default: int)", "description": "Helper to retrieve environment variables as integers with fallback to default.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] get_jwt_config()", "description": "Reads JWT configuration settings from environment variables, mandates presence of secret key.", "scope": "", "scopeKind": ""}, {"name": "str create_access_token(*, user: UserRecord)", "description": "Generates a JWT for a user, embedding user id, email, and package tier with expiration.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] decode_token(token: str)", "description": "Decodes a JWT token into its payload dictionary.", "scope": "", "scopeKind": ""}, {"name": "UserRecord get_current_user( token: str = Depends(oauth2_scheme), store: MemoryUserStore = Depends(lambda: store_singleton), )", "description": "FastAPI dependency to retrieve the current user from a Bearer token, raises HTTP 401 if invalid.", "scope": "", "scopeKind": ""}], "calls": ["jwt.encode", "jwt.decode", "decode_token", "MemoryUserStore.get_by_id"], "search-terms": ["JWT secret key configuration", "FastAPI OAuth2 security dependency", "JWT token creation and decoding", "In-memory user store singleton", "get_current_user dependency"], "state": 2, "file_id": 19, "knowledge_revision": 53, "git_revision": "", "ctags": [{"_type": "tag", "name": "_get_env", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^def _get_env(key: str, default: Optional[str] = None) -> Optional[str]:$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "function", "signature": "(key: str, default: Optional[str] = None)"}, {"_type": "tag", "name": "_int_env", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^def _int_env(key: str, default: int) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "function", "signature": "(key: str, default: int)"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^def create_access_token(*, user: UserRecord) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(*, user: UserRecord)"}, {"_type": "tag", "name": "decode_token", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^def decode_token(token: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^def get_current_user($/", "language": "Python", "typeref": "typename:UserRecord", "kind": "function", "signature": "( token: str = Depends(oauth2_scheme), store: MemoryUserStore = Depends(lambda: store_singleton), )"}, {"_type": "tag", "name": "get_jwt_config", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^def get_jwt_config() -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "oauth2_scheme", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "store_singleton", "path": "/home/kavia/workspace/code-generation/tailored-api-response-system-96060-96070/backend/app/security.py", "pattern": "/^store_singleton = MemoryUserStore()$/", "language": "Python", "kind": "variable"}], "hash": "d432c1a6423bd6655077266efcf9ddf4", "format-version": 4, "code-base-name": "backend", "filename": "backend/app/security.py", "fields": [{"name": "oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"\\/auth\\/login\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "store_singleton = MemoryUserStore()", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"53": ""}]}